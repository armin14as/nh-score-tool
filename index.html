<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>NH SCORE â€“ Ultra-Optimized UX</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
<style>
  *, *::before, *::after {
    box-sizing: border-box;
  }
  
  :root {
    --primary-gradient: linear-gradient(135deg, #7877c6, #533483);
    --secondary-gradient: linear-gradient(135deg, #00c6ff, #0072ff);
    --success-color: #10b981;
    --warning-color: #f59e0b;
    --error-color: #ef4444;
    --text-primary: #ffffff;
    --text-secondary: rgba(255, 255, 255, 0.85);
    --glass-bg: rgba(255, 255, 255, 0.05);
    --glass-border: rgba(255, 255, 255, 0.1);
    --shadow-primary: 0 20px 60px rgba(120, 119, 198, 0.3);
    --shadow-hover: 0 25px 70px rgba(120, 119, 198, 0.4);
  }

  body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 25%, #16213e 50%, #0f3460 75%, #533483 100%);
    color: var(--text-primary);
    margin: 0;
    padding: 0;
    overflow-x: hidden;
    scroll-behavior: smooth;
    line-height: 1.6;
  }

  body::before {
    content: "";
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-image:
      radial-gradient(circle at 25% 25%, rgba(120, 119, 198, 0.15) 0%, transparent 40%),
      radial-gradient(circle at 75% 75%, rgba(255, 255, 255, 0.06) 0%, transparent 40%);
    z-index: -1;
    pointer-events: none;
  }

  /* Enhanced Progress Bar with Mini Categories */
  .progress-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 6px;
    background: rgba(0, 0, 0, 0.3);
    z-index: 1000;
    backdrop-filter: blur(10px);
  }
  
  .progress-bar {
    height: 100%;
    width: 0%;
    background: var(--secondary-gradient);
    transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
  }
  
  .progress-bar::after {
    content: '';
    position: absolute;
    top: 0;
    right: 0;
    width: 20px;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.8));
    animation: progressShine 2s ease-in-out infinite;
  }
  
  @keyframes progressShine {
    0%, 100% { opacity: 0; }
    50% { opacity: 1; }
  }

  /* Mini Navigation */
  .mini-nav {
    position: fixed;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 8px;
    z-index: 999;
    padding: 8px 12px;
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    border-radius: 25px;
    backdrop-filter: blur(20px);
  }
  
  .nav-dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.3);
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
  }
  
  .nav-dot.completed {
    background: var(--success-color);
    box-shadow: 0 0 10px rgba(16, 185, 129, 0.5);
  }
  
  .nav-dot.active {
    background: var(--secondary-gradient);
    transform: scale(1.3);
    box-shadow: 0 0 15px rgba(0, 198, 255, 0.6);
  }
  
  .nav-dot:hover {
    transform: scale(1.2);
  }

  /* Floating Action Buttons */
  .fab-container {
    position: fixed;
    bottom: 30px;
    right: 30px;
    display: flex;
    flex-direction: column;
    gap: 15px;
    z-index: 998;
  }
  
  .fab {
    width: 56px;
    height: 56px;
    border-radius: 50%;
    background: var(--primary-gradient);
    border: none;
    color: white;
    font-size: 20px;
    cursor: pointer;
    box-shadow: var(--shadow-primary);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  .fab:hover {
    transform: translateY(-3px) scale(1.1);
    box-shadow: var(--shadow-hover);
  }
  
  .fab.save-fab {
    background: var(--success-color);
  }
  
  .fab.reset-fab {
    background: var(--error-color);
  }
  
  .fab.export-fab {
    background: linear-gradient(135deg, #667eea, #764ba2);
  }

  header {
    text-align: center;
    padding: 6rem 1rem 2rem;
    position: relative;
  }
  
  .main-title {
    font-size: clamp(2.5rem, 5vw, 4rem);
    font-weight: 900;
    background: linear-gradient(135deg, #ffffff, #7877c6, #00ffff);
    background-size: 200% 200%;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    margin-bottom: 1rem;
    animation: titleGradient 4s ease-in-out infinite;
  }
  
  @keyframes titleGradient {
    0%, 100% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
  }
  
  .subtitle {
    color: var(--text-secondary);
    font-size: clamp(1rem, 2.5vw, 1.25rem);
    max-width: 600px;
    margin: 0 auto;
  }

  /* Hero Stats */
  .hero-stats {
    display: flex;
    justify-content: center;
    gap: 3rem;
    margin-top: 2rem;
    flex-wrap: wrap;
  }
  
  .stat-item {
    text-align: center;
    background: var(--glass-bg);
    padding: 1.5rem 2rem;
    border-radius: 20px;
    border: 1px solid var(--glass-border);
    backdrop-filter: blur(15px);
    transition: all 0.3s ease;
  }
  
  .stat-item:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow-primary);
  }
  
  .stat-number {
    font-size: 2.5rem;
    font-weight: 900;
    background: var(--secondary-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    margin-bottom: 0.5rem;
  }
  
  .stat-label {
    color: var(--text-secondary);
    font-size: 0.9rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  .container {
    max-width: 1000px;
    margin: 0 auto;
    padding: 2rem 1rem;
  }

  /* Enhanced Total Score Box */
  .total-score-box {
    text-align: center;
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    backdrop-filter: blur(20px);
    border-radius: 2rem;
    padding: 2.5rem;
    margin-bottom: 3rem;
    box-shadow: var(--shadow-primary);
    position: sticky;
    top: 80px;
    z-index: 100;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  .total-score-box:hover {
    transform: translateY(-8px);
    box-shadow: var(--shadow-hover);
  }
  
  .score-header {
    margin-bottom: 1.5rem;
  }
  
  .score-header h3 {
    margin: 0 0 0.5rem 0;
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--text-primary);
  }
  
  .score-date {
    color: var(--text-secondary);
    font-size: 0.9rem;
  }
  
  .total-score-ring {
    position: relative;
    width: 200px;
    height: 200px;
    margin: 0 auto 1rem;
  }
  
  .total-score-ring canvas {
    position: absolute;
    top: 0;
    left: 0;
  }
  
  .score-value {
    position: absolute;
    top: 45%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 2.8rem;
    font-weight: 900;
    background: var(--secondary-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    line-height: 1;
  }
  
  .score-percentage {
    position: absolute;
    top: 60%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 1.2rem;
    font-weight: 600;
    color: var(--text-secondary);
  }
  
  .score-label {
    font-size: 1rem;
    color: var(--text-secondary);
    margin-bottom: 1rem;
  }
  
  .score-interpretation {
    background: rgba(120, 119, 198, 0.15);
    padding: 1rem 1.5rem;
    border-radius: 15px;
    margin: 1.5rem 0;
    font-weight: 600;
    font-size: 1rem;
    border: 1px solid rgba(120, 119, 198, 0.3);
  }
  
  .score-breakdown {
    display: flex;
    justify-content: space-around;
    margin-top: 1.5rem;
    padding-top: 1.5rem;
    border-top: 1px solid var(--glass-border);
  }
  
  .breakdown-item {
    text-align: center;
  }
  
  .breakdown-value {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--success-color);
  }
  
  .breakdown-label {
    font-size: 0.9rem;
    color: var(--text-secondary);
    margin-top: 0.5rem;
  }

  /* Enhanced Categories */
  .category {
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    border-radius: 2rem;
    padding: 2.5rem;
    margin-bottom: 2.5rem;
    backdrop-filter: blur(20px);
    box-shadow: var(--shadow-primary);
    position: relative;
    overflow: hidden;
    animation: fadeInUp 0.6s ease forwards;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  .category:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow-hover);
  }
  
  .category::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: var(--primary-gradient);
    opacity: 0.8;
    transition: all 0.3s ease;
  }
  
  .category.completed::before {
    background: var(--success-color);
    box-shadow: 0 0 15px rgba(16, 185, 129, 0.5);
  }
  
  .category.active::before {
    background: var(--secondary-gradient);
    box-shadow: 0 0 15px rgba(0, 198, 255, 0.5);
    animation: pulse 2s ease-in-out infinite;
  }
  
  @keyframes pulse {
    0%, 100% { opacity: 0.8; }
    50% { opacity: 1; }
  }

  .category-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 2rem;
    flex-wrap: wrap;
    gap: 1rem;
  }
  
  .category h2 {
    font-size: 1.5rem;
    margin: 0;
    background: var(--primary-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    font-weight: 700;
  }
  
  .category-score {
    background: rgba(120, 119, 198, 0.2);
    padding: 0.75rem 1.5rem;
    border-radius: 25px;
    font-weight: 700;
    color: #00e6e6;
    font-size: 1rem;
    min-width: 100px;
    text-align: center;
    border: 1px solid rgba(0, 230, 230, 0.3);
    transition: all 0.3s ease;
  }
  
  .category-progress {
    width: 100%;
    height: 6px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 3px;
    margin-top: 1rem;
    overflow: hidden;
  }
  
  .category-progress-fill {
    height: 100%;
    background: var(--secondary-gradient);
    border-radius: 3px;
    transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    width: 0%;
  }

  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(40px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Enhanced Questions */
  .question {
    margin-bottom: 2rem;
    padding: 1.5rem;
    background: rgba(255, 255, 255, 0.03);
    border-radius: 15px;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    border: 1px solid transparent;
  }
  
  .question:hover {
    background: rgba(255, 255, 255, 0.06);
    transform: translateX(5px);
  }
  
  .question.answered {
    border-color: var(--success-color);
    background: rgba(16, 185, 129, 0.05);
  }
  
  .question label {
    display: block;
    margin-bottom: 1rem;
    font-weight: 600;
    font-size: 1.1rem;
    color: var(--text-primary);
  }

  /* Ultra-Enhanced Radio Buttons */
  .radio-group {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
    gap: 1rem;
  }
  
  .radio-group input[type="radio"] {
    display: none;
  }
  
  .radio-group label {
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    background: rgba(120, 119, 198, 0.15);
    color: var(--text-primary);
    border-radius: 30px;
    padding: 1.2rem 1.8rem;
    cursor: pointer;
    font-weight: 600;
    font-size: 1rem;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow: inset 0 0 10px rgba(255, 255, 255, 0.1);
    border: 2px solid transparent;
    position: relative;
    overflow: hidden;
    min-height: 60px;
  }
  
  .radio-group label::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
    transition: left 0.6s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  .radio-group label:hover::before {
    left: 100%;
  }
  
  .radio-group label:hover {
    background: linear-gradient(135deg, #a292f1, #5a3f99);
    transform: translateY(-3px) scale(1.02);
    box-shadow: 0 12px 30px rgba(162, 146, 241, 0.4);
  }
  
  .radio-group input[type="radio"]:checked + span {
    display: inline-block;
    background: var(--primary-gradient);
    box-shadow: 0 0 25px rgba(124, 94, 221, 0.6), inset 0 0 20px rgba(255, 255, 255, 0.1);
    color: white;
    padding: 1.2rem 1.8rem;
    border-radius: 30px;
    font-weight: 800;
    font-size: 1.1rem;
    letter-spacing: 0.5px;
    animation: selectPulse 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    border: 2px solid rgba(255, 255, 255, 0.3);
  }
  
  /* Different colors for different values */
  .radio-group label:nth-child(1):has(input:checked) span { /* Nein */
    background: var(--error-color) !important;
    box-shadow: 0 0 25px rgba(239, 68, 68, 0.6) !important;
  }
  
  .radio-group label:nth-child(2):has(input:checked) span { /* Teilweise */
    background: var(--warning-color) !important;
    box-shadow: 0 0 25px rgba(245, 158, 11, 0.6) !important;
  }
  
  .radio-group label:nth-child(3):has(input:checked) span { /* Ja */
    background: var(--success-color) !important;
    box-shadow: 0 0 25px rgba(16, 185, 129, 0.6) !important;
  }
  
  @keyframes selectPulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.08); }
    100% { transform: scale(1); }
  }

  /* Enhanced Success Messages */
  .success-message {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: linear-gradient(135deg, #10b981, #059669);
    color: white;
    padding: 2.5rem 3.5rem;
    border-radius: 25px;
    box-shadow: 0 25px 80px rgba(16, 185, 129, 0.4);
    z-index: 1001;
    opacity: 0;
    visibility: hidden;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    text-align: center;
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.2);
  }
  
  .success-message h3 {
    margin: 0 0 1rem 0;
    font-size: 1.8rem;
    font-weight: 800;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
  }
  
  .success-message h3::before {
    content: "";
    width: 32px;
    height: 32px;
    background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='white' viewBox='0 0 24 24'%3E%3Cpath d='M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z'/%3E%3C/svg%3E") no-repeat center;
    background-size: contain;
  }
  
  .success-message.show {
    opacity: 1;
    visibility: visible;
    animation: successBounce 0.8s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  @keyframes successBounce {
    0% { transform: translate(-50%, -50%) scale(0.7) rotate(-5deg); }
    50% { transform: translate(-50%, -50%) scale(1.1) rotate(2deg); }
    100% { transform: translate(-50%, -50%) scale(1) rotate(0deg); }
  }

  /* Save/Load Notification */
  .notification {
    position: fixed;
    top: 100px;
    right: 30px;
    padding: 1rem 1.5rem;
    border-radius: 15px;
    color: white;
    font-weight: 600;
    z-index: 1002;
    opacity: 0;
    transform: translateX(100%);
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  .notification.show {
    opacity: 1;
    transform: translateX(0);
  }
  
  .notification.success {
    background: var(--success-color);
    box-shadow: 0 10px 30px rgba(16, 185, 129, 0.3);
  }
  
  .notification.error {
    background: var(--error-color);
    box-shadow: 0 10px 30px rgba(239, 68, 68, 0.3);
  }

  /* Responsive Enhancements */
  @media (max-width: 768px) {
    .container {
      padding: 1rem;
    }
    
    .hero-stats {
      gap: 1.5rem;
    }
    
    .stat-item {
      padding: 1rem 1.5rem;
    }
    
    .stat-number {
      font-size: 2rem;
    }
    
    .mini-nav {
      top: 10px;
      padding: 6px 10px;
    }
    
    .nav-dot {
      width: 10px;
      height: 10px;
    }
    
    .total-score-box {
      padding: 2rem;
      position: relative;
      top: unset;
    }
    
    .total-score-ring {
      width: 160px;
      height: 160px;
    }
    
    .score-value {
      font-size: 2.2rem;
    }
    
    .score-percentage {
      font-size: 1rem;
    }
    
    .category {
      padding: 2rem;
    }
    
    .category-header {
      flex-direction: column;
      align-items: flex-start;
      gap: 1rem;
    }
    
    .radio-group {
      grid-template-columns: 1fr;
      gap: 0.8rem;
    }
    
    .fab-container {
      bottom: 20px;
      right: 20px;
    }
    
    .fab {
      width: 48px;
      height: 48px;
      font-size: 18px;
    }
    
    .score-breakdown {
      flex-direction: column;
      gap: 1rem;
    }
    
    .breakdown-item {
      padding: 0.5rem;
    }
  }

  /* High contrast mode support */
  @media (prefers-contrast: high) {
    :root {
      --glass-bg: rgba(255, 255, 255, 0.1);
      --glass-border: rgba(255, 255, 255, 0.3);
      --text-secondary: rgba(255, 255, 255, 0.9);
    }
  }

  /* Reduced motion support */
  @media (prefers-reduced-motion: reduce) {
    *, *::before, *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
    }
  }

  /* Focus styles for accessibility */
  .radio-group label:focus-within {
    outline: 2px solid var(--secondary-gradient);
    outline-offset: 2px;
  }
  
  .fab:focus {
    outline: 2px solid var(--text-primary);
    outline-offset: 2px;
  }
</style>
</head>
<body>
  <div class="progress-container">
    <div class="progress-bar" id="progressBar"></div>
  </div>
  
  <nav class="mini-nav" id="miniNav"></nav>
  
  <div class="fab-container">
    <button class="fab export-fab" onclick="exportToPDF()" title="Als PDF exportieren">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
        <polyline points="14,2 14,8 20,8"/>
        <line x1="16" y1="13" x2="8" y2="13"/>
        <line x1="16" y1="17" x2="8" y2="17"/>
        <polyline points="10,9 9,9 8,9"/>
      </svg>
    </button>
    <button class="fab save-fab" onclick="saveProgress()" title="Fortschritt speichern">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
        <polyline points="17,21 17,13 7,13 7,21"/>
        <polyline points="7,3 7,8 15,8"/>
      </svg>
    </button>
    <button class="fab reset-fab" onclick="resetAll()" title="Alles zurÃ¼cksetzen">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="1 4 1 10 7 10"/>
        <polyline points="23 20 23 14 17 14"/>
        <path d="m20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4-4.64 4.36A9 9 0 0 1 3.51 15"/>
      </svg>
    </button>
    <button class="fab" onclick="scrollToTop()" title="Nach oben">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="12" y1="19" x2="12" y2="5"/>
        <polyline points="5,12 12,5 19,12"/>
      </svg>
    </button>
  </div>

  <header>
    <div class="b2bxsund-branding">
      <div class="b2bxsund-logo">
        <svg width="120" height="32" viewBox="0 0 400 100" fill="none" xmlns="http://www.w3.org/2000/svg">
          <!-- b2bXsund Logo Recreation -->
          <g fill="white">
            <!-- b2b -->
            <path d="M20 20 L20 80 L40 80 Q50 80 50 70 L50 55 Q50 50 45 50 Q50 50 50 45 L50 30 Q50 20 40 20 Z M30 30 L40 30 Q40 30 40 35 L40 40 Q40 45 35 45 L30 45 Z M30 55 L40 55 Q40 55 40 60 L40 65 Q40 70 35 70 L30 70 Z"/>
            <path d="M70 20 L70 50 L90 20 L100 20 L100 80 L90 80 L90 50 L70 80 L60 80 L60 20 Z"/>
            <path d="M120 20 L120 80 L140 80 Q150 80 150 70 L150 55 Q150 50 145 50 Q150 50 150 45 L150 30 Q150 20 140 20 Z M130 30 L140 30 Q140 30 140 35 L140 40 Q140 45 135 45 L130 45 Z M130 55 L140 55 Q140 55 140 60 L140 65 Q140 70 135 70 L130 70 Z"/>
            
            <!-- X with highlight box -->
            <rect x="170" y="35" width="30" height="30" rx="5" fill="rgba(255,255,255,0.2)" stroke="rgba(255,255,255,0.3)" stroke-width="1"/>
            <path d="M175 40 L195 60 M195 40 L175 60" stroke="white" stroke-width="3" stroke-linecap="round"/>
            
            <!-- sund -->
            <path d="M220 40 Q220 30 230 30 Q240 30 240 40 L240 45 L230 45 Q225 45 225 50 Q225 55 230 55 L240 55 L240 65 Q240 75 230 75 Q220 75 220 65 Z"/>
            <path d="M260 30 L260 75 L270 75 L270 65 Q270 75 280 75 Q290 75 290 65 L290 40 Q290 30 280 30 Q270 30 270 40 L270 30 Z M270 40 Q270 40 275 40 Q280 40 280 45 L280 60 Q280 65 275 65 Q270 65 270 60 Z"/>
            <path d="M310 30 L310 75 L320 75 L320 65 Q320 75 330 75 Q340 75 340 65 L340 40 Q340 30 330 30 Q320 30 320 40 L320 30 Z M320 40 Q320 40 325 40 Q330 40 330 45 L330 60 Q330 65 325 65 Q320 65 320 60 Z"/>
            <path d="M360 30 L360 75 L370 75 L370 65 Q370 75 380 75 Q390 75 390 65 L390 30 L380 30 L380 60 Q380 65 375 65 Q370 65 370 60 L370 30 Z"/>
          </g>
        </svg>
        <span class="brand-text">powered by b2bXsund</span>
      </div>
    </div>
    <h1 class="main-title">NH Score</h1>
    <p class="subtitle">Wissenschaftlich fundiertes 100-Punkte-System fÃ¼r umfassende Gesundheit & LeistungsfÃ¤higkeit</p>
    <div class="hero-stats">
      <div class="stat-item">
        <div class="stat-number">5</div>
        <div class="stat-label">Kategorien</div>
      </div>
      <div class="stat-item">
        <div class="stat-number">50</div>
        <div class="stat-label">Fragen</div>
      </div>
      <div class="stat-item">
        <div class="stat-number">100</div>
        <div class="stat-label">Max. Punkte</div>
      </div>
    </div>
  </header>

  <main class="container">
    <section class="total-score-box">
      <div class="score-header">
        <h3>Ihr aktueller Gesundheitsscore</h3>
        <div class="score-date" id="scoreDate"></div>
      </div>
      <div class="total-score-ring">
        <canvas id="scoreRing" width="200" height="200"></canvas>
        <div class="score-value" id="totalScore">0</div>
        <div class="score-percentage" id="scorePercentage">0%</div>
      </div>
      <div class="score-label">von 100 mÃ¶glichen Punkten</div>
      <div class="score-interpretation" id="scoreInterpretation">
        Starten Sie mit der ersten Kategorie
      </div>
      <div class="score-breakdown">
        <div class="breakdown-item">
          <div class="breakdown-value" id="completedQuestions">0</div>
          <div class="breakdown-label">Beantwortet</div>
        </div>
        <div class="breakdown-item">
          <div class="breakdown-value" id="completedCategories">0</div>
          <div class="breakdown-label">Abgeschlossen</div>
        </div>
        <div class="breakdown-item">
          <div class="breakdown-value" id="averageScore">0%</div>
          <div class="breakdown-label">Durchschnitt</div>
        </div>
      </div>
    </section>
    
    <div id="categories"></div>
  </main>

  <div class="success-message" id="successMessage">
    <h3>Kategorie erfolgreich abgeschlossen!</h3>
    <p>GroÃŸartig! Du machst echte Fortschritte.</p>
  </div>
  
  <div class="notification" id="notification"></div>

  <script>
    // Enhanced Chart Configuration
    const ctx = document.getElementById('scoreRing').getContext('2d');
    const scoreChart = new Chart(ctx, {
      type: 'doughnut',
      data: {
        labels: ['Erreichte Punkte', 'Verbleibende Punkte'],
        datasets: [{
          data: [0, 100],
          backgroundColor: [
            'rgba(0, 198, 255, 0.8)',
            'rgba(255, 255, 255, 0.1)'
          ],
          borderColor: [
            'rgba(0, 198, 255, 1)',
            'rgba(255, 255, 255, 0.2)'
          ],
          borderWidth: 2,
        }]
      },
      options: {
        cutout: '75%',
        plugins: { 
          legend: { display: false },
          tooltip: {
            callbacks: {
              label: function(context) {
                return context.label + ': ' + context.parsed + ' Punkte';
              }
            }
          }
        },
        animation: {
          animateRotate: true,
          duration: 1500,
          easing: 'easeInOutCubic'
        }
      }
    });

    const categories = [
      {
        title: 'Schlaf & Erholung',
        icon: 'ðŸŒ™',
        iconSvg: `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
        </svg>`,
        questions: [
          'SchlÃ¤fst du mindestens 7â€“8 Stunden pro Nacht?',
          'Hast du einen regelmÃ¤ÃŸigen Schlaf-Wach-Rhythmus?',
          'Wachst du ohne Wecker erholt auf?',
          'SchlÃ¤fst du ohne Unterbrechungen durch?',
          'Vermeidest du Blaulicht 2h vor dem Schlafengehen?',
          'SchlÃ¤fst du in einem vÃ¶llig dunklen Raum?',
          'Wachst du erfrischt und energiegeladen auf?',
          'Vermeidest du spÃ¤te und schwere Mahlzeiten?',
          'Kommst du ohne Schlafmittel oder Alkohol aus?',
          'FÃ¼hlst du dich tagsÃ¼ber wach und konzentriert?'
        ]
      },
      {
        title: 'ErnÃ¤hrung & Supplements',
        icon: 'ðŸ¥—',
        iconSvg: `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M18 8h1a4 4 0 0 1 0 8h-1"/>
          <path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"/>
          <line x1="6" y1="1" x2="6" y2="4"/>
          <line x1="10" y1="1" x2="10" y2="4"/>
          <line x1="14" y1="1" x2="14" y2="4"/>
        </svg>`,
        questions: [
          'Verzichtest du weitgehend auf raffinierten Zucker?',
          'Isst du tÃ¤glich mindestens 5 Portionen GemÃ¼se/Obst?',
          'Trinkst du tÃ¤glich 2-3 Liter reines Wasser?',
          'Verwendest du Supplements gezielt nach Bedarf?',
          'Hast du regelmÃ¤ÃŸige und bewusste Essenszeiten?',
          'Isst du ballaststoffreich und nÃ¤hrstoffdicht?',
          'Vermeidest du hochverarbeitete Fertigprodukte?',
          'Meidest du kÃ¼nstliche ZusÃ¤tze und Konservierungsstoffe?',
          'Hast du eine gesunde Verdauung ohne Probleme?',
          'Verzichtest du auf kÃ¼nstliche SÃ¼ÃŸstoffe?'
        ]
      },
      {
        title: 'Training & Bewegung',
        icon: 'ðŸ’ª',
        iconSvg: `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M6.5 6.5h.01"/>
          <path d="M6.5 17.5h.01"/>
          <path d="M17.5 6.5h.01"/>
          <path d="M17.5 17.5h.01"/>
          <rect x="9" y="7" width="6" height="10" rx="1"/>
        </svg>`,
        questions: [
          'Bewegst du dich tÃ¤glich mindestens 30 Minuten?',
          'Trainierst du 3-4x pro Woche strukturiert?',
          'Schaffst du problemlos 10.000 Schritte tÃ¤glich?',
          'Bist du schmerzfrei und beweglich?',
          'Hast du klare sportliche Ziele und Motivation?',
          'Folgst du einem durchdachten Trainingsplan?',
          'Trainierst du regelmÃ¤ÃŸig deine Ausdauer?',
          'Trainierst du systematisch deine Kraft?',
          'Bist du flexibel und hast gute MobilitÃ¤t?',
          'Kannst du problemlos lÃ¤nger laufen/gehen?'
        ]
      },
      {
        title: 'Mindset & Stressmanagement',
        icon: 'ðŸ§ ',
        iconSvg: `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M9.663 17h4.673M12 3a6.364 6.364 0 0 0 6.364 6.364 6.364 6.364 0 0 1-6.364 6.364 6.364 6.364 0 0 1-6.364-6.364A6.364 6.364 0 0 0 12 3z"/>
          <path d="M9 9h.01"/>
          <path d="M15 15h.01"/>
        </svg>`,
        questions: [
          'FÃ¼hlst du dich selten Ã¼berwÃ¤ltigt oder gestresst?',
          'Praktizierst du regelmÃ¤ÃŸig Meditation oder Achtsamkeit?',
          'Umgibst du dich mit positiven EinflÃ¼ssen?',
          'Hast du klare Lebensziele und PrioritÃ¤ten?',
          'Lebst du nach deinen persÃ¶nlichen Werten?',
          'Hast du eine grundsÃ¤tzlich optimistische Einstellung?',
          'Vermeidest du Multitasking und Ablenkungen?',
          'Hast du starke soziale Verbindungen und UnterstÃ¼tzung?',
          'Kannst du nach der Arbeit wirklich abschalten?',
          'FÃ¼hlst du dich meistens glÃ¼cklich und erfÃ¼llt?'
        ]
      },
      {
        title: 'Lifestyle & Umwelt',
        icon: 'ðŸŒ±',
        iconSvg: `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
          <path d="M9 12l2 2 4-4"/>
        </svg>`,
        questions: [
          'Rauchst du nicht und meidest Passivrauchen?',
          'Trinkst du maximal 1-2 GlÃ¤ser Alkohol pro Woche?',
          'Vermeidest du Plastik bei Lebensmitteln und GetrÃ¤nken?',
          'Hast du Zugang zu sauberem, gefiltertem Wasser?',
          'Meidest du schÃ¤dliche Chemikalien im Alltag?',
          'Verwendest du natÃ¼rliche KÃ¶rperpflege ohne Toxine?',
          'SchlÃ¤fst du in einem schadstofffreien Umfeld?',
          'Bekommst du tÃ¤glich natÃ¼rliches Tageslicht?',
          'Verbringst du regelmÃ¤ÃŸig Zeit in der Natur?',
          'FÃ¼hrst du einen bewusst nachhaltigen Lebensstil?'
        ]
      }
    ];

    const categoriesEl = document.getElementById('categories');
    const answers = [];
    let completedCategories = 0;
    let currentActiveCategory = 0;

    // Initialize answers array
    categories.forEach((cat, catIdx) => {
      answers[catIdx] = Array(cat.questions.length).fill(null);
    });

    // Create mini navigation
    function createMiniNav() {
      const miniNav = document.getElementById('miniNav');
      categories.forEach((cat, idx) => {
        const dot = document.createElement('div');
        dot.className = 'nav-dot';
        dot.title = cat.title;
        dot.onclick = () => scrollToCategory(idx);
        miniNav.appendChild(dot);
      });
    }

    // Create categories
    function createCategories() {
      categories.forEach((cat, catIdx) => {
        const catEl = document.createElement('section');
        catEl.className = 'category';
        catEl.id = `category-${catIdx}`;
        
        const headerEl = document.createElement('div');
        headerEl.className = 'category-header';
        
        const titleContainer = document.createElement('div');
        titleContainer.style.cssText = 'display: flex; align-items: center; gap: 1rem;';
        
        // Create professional icon container
        const iconContainer = document.createElement('div');
        iconContainer.style.cssText = `
          width: 44px;
          height: 44px;
          background: var(--primary-gradient);
          border-radius: 12px;
          display: flex;
          align-items: center;
          justify-content: center;
          color: white;
          flex-shrink: 0;
          box-shadow: 0 4px 12px rgba(120, 119, 198, 0.3);
        `;
        iconContainer.innerHTML = cat.iconSvg;
        
        const title = document.createElement('h2');
        title.textContent = cat.title;
        
        titleContainer.appendChild(iconContainer);
        titleContainer.appendChild(title);
        
        const scoreEl = document.createElement('div');
        scoreEl.className = 'category-score';
        scoreEl.id = `score-${catIdx}`;
        scoreEl.textContent = '0 / 20';
        
        headerEl.appendChild(titleContainer);
        headerEl.appendChild(scoreEl);
        catEl.appendChild(headerEl);
        
        // Category progress bar
        const progressContainer = document.createElement('div');
        progressContainer.className = 'category-progress';
        const progressFill = document.createElement('div');
        progressFill.className = 'category-progress-fill';
        progressFill.id = `progress-${catIdx}`;
        progressContainer.appendChild(progressFill);
        catEl.appendChild(progressContainer);

        cat.questions.forEach((q, qIdx) => {
          const qEl = document.createElement('div');
          qEl.className = 'question';
          qEl.id = `question-${catIdx}-${qIdx}`;
          
          const label = document.createElement('label');
          label.textContent = `${qIdx + 1}. ${q}`;
          qEl.appendChild(label);
          
          const group = document.createElement('div');
          group.className = 'radio-group';

          ['Nein', 'Teilweise', 'Ja'].forEach((text, val) => {
            const id = `cat${catIdx}_q${qIdx}_v${val}`;
            const radio = document.createElement('input');
            radio.type = 'radio';
            radio.name = `cat${catIdx}_q${qIdx}`;
            radio.value = val;
            radio.id = id;
            radio.onchange = () => handleAnswerChange(catIdx, qIdx, parseInt(radio.value));
            
            const span = document.createElement('span');
            span.textContent = text;
            
            const lbl = document.createElement('label');
            lbl.htmlFor = id;
            lbl.appendChild(radio);
            lbl.appendChild(span);
            group.appendChild(lbl);
          });
          
          qEl.appendChild(group);
          catEl.appendChild(qEl);
        });

        categoriesEl.appendChild(catEl);
      });
    }

    // Handle answer changes with enhanced feedback
    function handleAnswerChange(catIdx, qIdx, value) {
      answers[catIdx][qIdx] = value;
      
      // Mark question as answered
      const questionEl = document.getElementById(`question-${catIdx}-${qIdx}`);
      questionEl.classList.add('answered');
      
      // Add subtle animation
      questionEl.style.transform = 'scale(1.02)';
      setTimeout(() => {
        questionEl.style.transform = 'scale(1)';
      }, 200);
      
      updateScores();
      updateMiniNav();
      checkCategoryCompletion(catIdx);
      
      // Auto-save progress
      saveProgress(true);
    }

    // Enhanced score updates with professional interpretation
    function updateScores() {
      let total = 0;
      let answeredQuestions = 0;
      const totalQuestions = categories.reduce((sum, cat) => sum + cat.questions.length, 0);
      let completedCats = 0;
      
      answers.forEach((group, i) => {
        const sum = group.reduce((a, b) => a + (b !== null ? b : 0), 0);
        const answered = group.filter(a => a !== null).length;
        const percentage = answered > 0 ? (answered / group.length * 100) : 0;
        
        total += sum;
        answeredQuestions += answered;
        
        if (answered === group.length) completedCats++;
        
        // Update category score and progress
        document.getElementById(`score-${i}`).textContent = `${sum} / 20`;
        document.getElementById(`progress-${i}`).style.width = percentage + '%';
      });
      
      const overallPercentage = totalQuestions > 0 ? Math.round((total / (totalQuestions * 2)) * 100) : 0;
      
      // Update main score display
      document.getElementById('totalScore').textContent = total;
      document.getElementById('scorePercentage').textContent = overallPercentage + '%';
      document.getElementById('completedQuestions').textContent = `${answeredQuestions}/${totalQuestions}`;
      document.getElementById('completedCategories').textContent = `${completedCats}/5`;
      document.getElementById('averageScore').textContent = overallPercentage + '%';
      
      // Update score interpretation
      updateScoreInterpretation(total, overallPercentage, answeredQuestions, totalQuestions);
      
      // Update date
      document.getElementById('scoreDate').textContent = `Stand: ${new Date().toLocaleDateString('de-DE')}`;
      
      // Update chart with smooth animation
      scoreChart.data.datasets[0].data = [total, 100 - total];
      scoreChart.update('active');
      
      // Update progress bar
      const progress = (answeredQuestions / totalQuestions) * 100;
      document.getElementById('progressBar').style.width = progress + '%';
      
      // Update chart colors based on score
      let chartColor = 'rgba(239, 68, 68, 0.8)'; // Red for low scores
      if (overallPercentage >= 40) chartColor = 'rgba(245, 158, 11, 0.8)'; // Orange for medium
      if (overallPercentage >= 70) chartColor = 'rgba(16, 185, 129, 0.8)'; // Green for high
      
      scoreChart.data.datasets[0].backgroundColor[0] = chartColor;
      scoreChart.update();
    }

    // Professional score interpretation
    function updateScoreInterpretation(total, percentage, answered, totalQuestions) {
      const interpretationEl = document.getElementById('scoreInterpretation');
      
      if (answered === 0) {
        interpretationEl.textContent = 'Beginnen Sie mit der Bewertung Ihrer Gesundheit';
        interpretationEl.style.background = 'rgba(120, 119, 198, 0.15)';
        return;
      }
      
      if (answered < totalQuestions) {
        interpretationEl.textContent = `Bewertung lÃ¤uft... ${Math.round((answered/totalQuestions)*100)}% abgeschlossen`;
        interpretationEl.style.background = 'rgba(245, 158, 11, 0.15)';
        return;
      }
      
      let interpretation = '';
      let bgColor = '';
      
      if (percentage >= 85) {
        interpretation = 'Ausgezeichnet! Ihr Gesundheitsstatus ist vorbildlich.';
        bgColor = 'rgba(16, 185, 129, 0.15)';
      } else if (percentage >= 70) {
        interpretation = 'Sehr gut! Sie haben eine solide Gesundheitsbasis.';
        bgColor = 'rgba(16, 185, 129, 0.15)';
      } else if (percentage >= 55) {
        interpretation = 'Gut! Es gibt noch Optimierungspotential.';
        bgColor = 'rgba(245, 158, 11, 0.15)';
      } else if (percentage >= 40) {
        interpretation = 'VerbesserungswÃ¼rdig. Fokus auf SchlÃ¼sselbereiche empfohlen.';
        bgColor = 'rgba(245, 158, 11, 0.15)';
      } else {
        interpretation = 'Handlungsbedarf! Professionelle Beratung empfohlen.';
        bgColor = 'rgba(239, 68, 68, 0.15)';
      }
      
      interpretationEl.textContent = interpretation;
      interpretationEl.style.background = bgColor;
    }

    // Update mini navigation
    function updateMiniNav() {
      const dots = document.querySelectorAll('.nav-dot');
      answers.forEach((group, i) => {
        const answered = group.filter(a => a !== null).length;
        const isCompleted = answered === group.length;
        const isActive = i === currentActiveCategory;
        
        dots[i].classList.toggle('completed', isCompleted);
        dots[i].classList.toggle('active', isActive && !isCompleted);
      });
    }

    // Enhanced category completion check
    function checkCategoryCompletion(catIdx) {
      const category = answers[catIdx];
      const isComplete = category.every(answer => answer !== null);
      const categoryEl = document.getElementById(`category-${catIdx}`);
      
      if (isComplete) {
        categoryEl.classList.add('completed');
        showSuccessMessage();
        
        // Update active category to next incomplete one
        updateActiveCategory();
        
        // Auto-scroll to next category after delay
        const nextCategory = findNextIncompleteCategory(catIdx);
        if (nextCategory !== -1) {
          setTimeout(() => {
            scrollToCategory(nextCategory);
          }, 2000);
        } else {
          // All categories completed - show final celebration
          setTimeout(() => {
            showFinalCelebration();
          }, 2000);
        }
      }
    }

    // Find next incomplete category
    function findNextIncompleteCategory(currentIdx) {
      for (let i = currentIdx + 1; i < answers.length; i++) {
        if (!answers[i].every(answer => answer !== null)) {
          return i;
        }
      }
      return -1;
    }

    // Update active category
    function updateActiveCategory() {
      document.querySelectorAll('.category').forEach(cat => cat.classList.remove('active'));
      
      const nextIncomplete = findNextIncompleteCategory(-1);
      if (nextIncomplete !== -1) {
        currentActiveCategory = nextIncomplete;
        document.getElementById(`category-${nextIncomplete}`).classList.add('active');
      }
    }

    // Enhanced success message
    function showSuccessMessage() {
      const msg = document.getElementById('successMessage');
      msg.classList.add('show');
      
      // Add confetti effect (simple version)
      createConfetti();
      
      setTimeout(() => {
        msg.classList.remove('show');
      }, 3000);
    }

    // Simple confetti effect
    function createConfetti() {
      const colors = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#feca57'];
      for (let i = 0; i < 50; i++) {
        const confetti = document.createElement('div');
        confetti.style.cssText = `
          position: fixed;
          width: 10px;
          height: 10px;
          background: ${colors[Math.floor(Math.random() * colors.length)]};
          left: ${Math.random() * 100}vw;
          top: -10px;
          border-radius: 50%;
          animation: confettiFall ${Math.random() * 2 + 1}s linear forwards;
          z-index: 1003;
        `;
        document.body.appendChild(confetti);
        
        setTimeout(() => confetti.remove(), 3000);
      }
    }

    // Add confetti animation to CSS
    const style = document.createElement('style');
    style.textContent = `
      @keyframes confettiFall {
        to {
          transform: translateY(100vh) rotate(360deg);
          opacity: 0;
        }
      }
    `;
    document.head.appendChild(style);

    // Final celebration
    function showFinalCelebration() {
      const finalMsg = document.createElement('div');
      finalMsg.style.cssText = `
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 3rem;
        border-radius: 30px;
        text-align: center;
        z-index: 1004;
        box-shadow: 0 30px 100px rgba(102, 126, 234, 0.4);
        backdrop-filter: blur(20px);
        animation: finalCelebration 1s cubic-bezier(0.4, 0, 0.2, 1);
      `;
      finalMsg.innerHTML = `
        <h2 style="margin: 0 0 1rem 0; font-size: 2.5rem; display: flex; align-items: center; justify-content: center; gap: 1rem;">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
          </svg>
          Fantastisch!
        </h2>
        <p style="margin: 0; font-size: 1.2rem;">Du hast alle Kategorien abgeschlossen!<br>
        Dein NH Score zeigt deinen aktuellen Gesundheitsstatus.</p>
      `;
      
      document.body.appendChild(finalMsg);
      createConfetti();
      
      setTimeout(() => finalMsg.remove(), 5000);
    }

    // Scroll functions
    function scrollToCategory(index) {
      currentActiveCategory = index;
      updateMiniNav();
      document.getElementById(`category-${index}`).scrollIntoView({ 
        behavior: 'smooth', 
        block: 'center' 
      });
    }

    function scrollToTop() {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // Save/Load functionality
    function saveProgress(silent = false) {
      try {
        const data = {
          answers: answers,
          timestamp: Date.now(),
          version: '2.0'
        };
        const savedData = JSON.stringify(data);
        
        // Create a download link
        const blob = new Blob([savedData], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `nh-score-${new Date().toISOString().split('T')[0]}.json`;
        
        if (!silent) {
          a.click();
          showNotification('Fortschritt erfolgreich gespeichert!', 'success');
        }
        
        URL.revokeObjectURL(url);
      } catch (error) {
        showNotification('Fehler beim Speichern!', 'error');
      }
    }

    function loadProgress() {
      const input = document.createElement('input');
      input.type = 'file';
      input.accept = '.json';
      input.onchange = (e) => {
        const file = e.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = (e) => {
            try {
              const data = JSON.parse(e.target.result);
              if (data.answers && data.version) {
                answers.splice(0, answers.length, ...data.answers);
                restoreAnswers();
                updateScores();
                updateMiniNav();
                showNotification('Fortschritt erfolgreich geladen!', 'success');
              }
            } catch (error) {
              showNotification('Fehler beim Laden der Datei!', 'error');
            }
          };
          reader.readAsText(file);
        }
      };
      input.click();
    }

    function restoreAnswers() {
      answers.forEach((group, catIdx) => {
        group.forEach((answer, qIdx) => {
          if (answer !== null) {
            const radio = document.getElementById(`cat${catIdx}_q${qIdx}_v${answer}`);
            if (radio) {
              radio.checked = true;
              const questionEl = document.getElementById(`question-${catIdx}-${qIdx}`);
              questionEl.classList.add('answered');
            }
          }
        });
      });
    }

    function resetAll() {
      if (confirm('MÃ¶chtest du wirklich alle Antworten zurÃ¼cksetzen?')) {
        answers.forEach((group, i) => {
          group.fill(null);
        });
        
        // Reset all radio buttons
        document.querySelectorAll('input[type="radio"]').forEach(radio => {
          radio.checked = false;
        });
        
        // Reset visual states
        document.querySelectorAll('.question').forEach(q => {
          q.classList.remove('answered');
        });
        
        document.querySelectorAll('.category').forEach(cat => {
          cat.classList.remove('completed', 'active');
        });
        
        currentActiveCategory = 0;
        document.getElementById('category-0').classList.add('active');
        
        updateScores();
        updateMiniNav();
        showNotification('Alle Antworten zurÃ¼ckgesetzt!', 'success');
        scrollToTop();
      }
    }

    // PDF Export functionality
    function exportToPDF() {
      const exportData = generateExportData();
      const printWindow = window.open('', '_blank');
      
      printWindow.document.write(`
        <!DOCTYPE html>
        <html>
        <head>
          <title>NH Score Auswertung</title>
          <style>
            body { font-family: Arial, sans-serif; margin: 40px; color: #333; }
            .header { text-align: center; margin-bottom: 40px; border-bottom: 2px solid #7877c6; padding-bottom: 20px; }
            .score-summary { background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 30px; }
            .category { margin-bottom: 25px; page-break-inside: avoid; }
            .category h3 { color: #7877c6; border-bottom: 1px solid #ddd; padding-bottom: 5px; }
            .question { margin: 10px 0; padding: 8px; background: #f8f9fa; border-radius: 5px; }
            .answer { font-weight: bold; }
            .answer.ja { color: #10b981; }
            .answer.teilweise { color: #f59e0b; }
            .answer.nein { color: #ef4444; }
            .footer { margin-top: 40px; text-align: center; font-size: 12px; color: #666; }
            @media print { body { margin: 20px; } }
          </style>
        </head>
        <body>
          ${exportData}
        </body>
        </html>
      `);
      
      printWindow.document.close();
      setTimeout(() => {
        printWindow.print();
      }, 500);
    }

    function generateExportData() {
      const total = answers.reduce((sum, group) => sum + group.reduce((a, b) => a + (b !== null ? b : 0), 0), 0);
      const totalQuestions = categories.reduce((sum, cat) => sum + cat.questions.length, 0);
      const percentage = Math.round((total / (totalQuestions * 2)) * 100);
      const date = new Date().toLocaleDateString('de-DE');
      
      let html = `
        <div class="header">
          <h1>NH Score Gesundheitsauswertung</h1>
          <p>Datum: ${date}</p>
          <h2>Gesamtergebnis: ${total}/100 Punkte (${percentage}%)</h2>
        </div>
        
        <div class="score-summary">
          <h3>Zusammenfassung</h3>
          <p><strong>Gesamtpunkte:</strong> ${total} von 100</p>
          <p><strong>Prozentualer Wert:</strong> ${percentage}%</p>
          <p><strong>Beantwortete Fragen:</strong> ${answers.reduce((sum, group) => sum + group.filter(a => a !== null).length, 0)} von ${totalQuestions}</p>
        </div>
      `;
      
      categories.forEach((cat, catIdx) => {
        const categorySum = answers[catIdx].reduce((a, b) => a + (b !== null ? b : 0), 0);
        const categoryPercentage = Math.round((categorySum / 20) * 100);
        
        html += `
          <div class="category">
            <h3>
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#7877c6" stroke-width="2" style="margin-right: 8px; vertical-align: middle;">
                ${cat.iconSvg.match(/<path[^>]*d="[^"]*"/g)?.join('') || ''}
              </svg>
              ${cat.title} - ${categorySum}/20 Punkte (${categoryPercentage}%)
            </h3>
        `;
        
        cat.questions.forEach((question, qIdx) => {
          const answer = answers[catIdx][qIdx];
          let answerText = 'Nicht beantwortet';
          let answerClass = '';
          
          if (answer === 2) { answerText = 'Ja'; answerClass = 'ja'; }
          else if (answer === 1) { answerText = 'Teilweise'; answerClass = 'teilweise'; }
          else if (answer === 0) { answerText = 'Nein'; answerClass = 'nein'; }
          
          html += `
            <div class="question">
              <strong>${qIdx + 1}. ${question}</strong><br>
              <span class="answer ${answerClass}">Antwort: ${answerText}</span>
            </div>
          `;
        });
        
        html += '</div>';
      });
      
      html += `
        <div class="footer">
          <p>Erstellt mit NH Score - Gesundheitsbewertungssystem</p>
          <p>Diese Auswertung dient der SelbsteinschÃ¤tzung und ersetzt keine professionelle medizinische Beratung.</p>
        </div>
      `;
      
      return html;
    }

    // Notification system
    function showNotification(message, type = 'success') {
      const notification = document.getElementById('notification');
      notification.textContent = message;
      notification.className = `notification ${type}`;
      notification.classList.add('show');
      
      setTimeout(() => {
        notification.classList.remove('show');
      }, 3000);
    }

    // Keyboard shortcuts
    document.addEventListener('keydown', (e) => {
      if (e.ctrlKey || e.metaKey) {
        switch (e.key) {
          case 's':
            e.preventDefault();
            saveProgress();
            break;
          case 'o':
            e.preventDefault();
            loadProgress();
            break;
          case 'r':
            e.preventDefault();
            if (e.shiftKey) resetAll();
            break;
        }
      }
    });

    // Initialize everything
    document.addEventListener('DOMContentLoaded', () => {
      createMiniNav();
      createCategories();
      updateActiveCategory();
      updateMiniNav();
      
      // Auto-scroll to first category after a short delay
      setTimeout(() => {
        scrollToCategory(0);
      }, 1000);
      
      // Add load functionality to FAB
      const fabContainer = document.querySelector('.fab-container');
      const loadFab = document.createElement('button');
      loadFab.className = 'fab';
      loadFab.innerHTML = `
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
          <polyline points="14,2 14,8 20,8"/>
          <line x1="12" y1="11" x2="12" y2="17"/>
          <polyline points="9,14 12,17 15,14"/>
        </svg>
      `;
      loadFab.title = 'Fortschritt laden';
      loadFab.onclick = loadProgress;
      loadFab.style.background = 'linear-gradient(135deg, #667eea, #764ba2)';
      fabContainer.insertBefore(loadFab, fabContainer.children[1]);
    });
  </script>
</body>
</html>
