<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="NH Score - Wissenschaftlich fundiertes Gesundheitsbewertungssystem" />
<title>NH SCORE – Professional Health Assessment</title>
<style>
  :root {
    --primary: #6366f1;
    --primary-dark: #4f46e5;
    --success: #10b981;
    --warning: #f59e0b;
    --error: #ef4444;
    --gray-50: #f9fafb;
    --gray-100: #f3f4f6;
    --gray-200: #e5e7eb;
    --gray-300: #d1d5db;
    --gray-600: #4b5563;
    --gray-700: #374151;
    --gray-800: #1f2937;
    --gray-900: #111827;
    --bg-primary: #0f172a;
    --bg-secondary: #1e293b;
    --text-primary: #f8fafc;
    --text-secondary: #cbd5e1;
    --border-color: rgba(148, 163, 184, 0.1);
    --glass-bg: rgba(30, 41, 59, 0.4);
    --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }
  
  body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
    color: var(--text-primary);
    line-height: 1.6;
    min-height: 100vh;
  }

  /* Enhanced Progress Bar */
  .progress-header {
    position: sticky;
    top: 0;
    background: var(--glass-bg);
    backdrop-filter: blur(12px);
    border-bottom: 1px solid var(--border-color);
    z-index: 100;
    padding: 1rem 0;
  }
  
  .progress-content {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 1rem;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 1rem;
  }
  
  .progress-info {
    display: flex;
    align-items: center;
    gap: 1rem;
    font-size: 0.875rem;
    color: var(--text-secondary);
  }
  
  .progress-bar-container {
    flex: 1;
    max-width: 400px;
    height: 8px;
    background: var(--gray-800);
    border-radius: 4px;
    overflow: hidden;
  }
  
  .progress-bar {
    height: 100%;
    background: linear-gradient(90deg, var(--primary), var(--success));
    border-radius: 4px;
    transition: width 0.3s ease;
    width: 0%;
  }

  /* Category Navigation */
  .category-nav {
    display: flex;
    gap: 0.5rem;
    align-items: center;
  }
  
  .category-dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: var(--gray-600);
    cursor: pointer;
    transition: all 0.2s ease;
  }
  
  .category-dot.completed { background: var(--success); }
  .category-dot.active { background: var(--primary); transform: scale(1.2); }
  .category-dot:hover { transform: scale(1.1); }

  /* Action Buttons */
  .action-buttons {
    display: flex;
    gap: 0.5rem;
  }
  
  .btn {
    padding: 0.5rem 1rem;
    border: 1px solid var(--border-color);
    background: var(--glass-bg);
    color: var(--text-primary);
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.875rem;
    transition: all 0.15s ease;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }
  
  .btn:hover {
    background: var(--gray-700);
    border-color: var(--gray-600);
  }
  
  .btn.primary {
    background: var(--primary);
    border-color: var(--primary);
  }
  
  .btn.primary:hover {
    background: var(--primary-dark);
  }

  /* Main Layout */
  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 2rem 1rem;
    display: grid;
    grid-template-columns: 1fr 300px;
    gap: 2rem;
  }

  /* Score Panel */
  .score-panel {
    background: var(--glass-bg);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    padding: 1.5rem;
    backdrop-filter: blur(12px);
    height: fit-content;
    position: sticky;
    top: 120px;
  }
  
  .score-header h3 {
    font-size: 1.125rem;
    margin-bottom: 0.5rem;
  }
  
  .score-date {
    font-size: 0.875rem;
    color: var(--text-secondary);
    margin-bottom: 1.5rem;
  }
  
  .score-ring {
    position: relative;
    width: 120px;
    height: 120px;
    margin: 0 auto 1rem;
  }
  
  .score-circle {
    width: 120px;
    height: 120px;
    border-radius: 50%;
    background: conic-gradient(var(--primary) 0deg, var(--gray-700) 0deg);
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
  }
  
  .score-circle::before {
    content: '';
    width: 80px;
    height: 80px;
    background: var(--bg-secondary);
    border-radius: 50%;
    position: absolute;
  }
  
  .score-value {
    position: relative;
    z-index: 1;
    font-size: 1.5rem;
    font-weight: 700;
    text-align: center;
    line-height: 1.2;
  }
  
  .score-percentage {
    font-size: 0.875rem;
    color: var(--text-secondary);
  }
  
  .score-stats {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
    margin-top: 1.5rem;
    padding-top: 1.5rem;
    border-top: 1px solid var(--border-color);
  }
  
  .stat-item {
    text-align: center;
  }
  
  .stat-value {
    font-size: 1.25rem;
    font-weight: 600;
    color: var(--success);
  }
  
  .stat-label {
    font-size: 0.75rem;
    color: var(--text-secondary);
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  /* Categories */
  .categories {
    display: flex;
    flex-direction: column;
    gap: 2rem;
  }
  
  .category {
    background: var(--glass-bg);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    padding: 2rem;
    backdrop-filter: blur(12px);
    transition: all 0.2s ease;
  }
  
  .category.active {
    border-color: var(--primary);
    box-shadow: 0 0 0 1px var(--primary);
  }
  
  .category-header {
    display: flex;
    justify-content: between;
    align-items: center;
    margin-bottom: 1.5rem;
    gap: 1rem;
  }
  
  .category-title {
    font-size: 1.25rem;
    font-weight: 600;
    flex: 1;
  }
  
  .category-score {
    background: var(--gray-800);
    padding: 0.5rem 1rem;
    border-radius: 20px;
    font-size: 0.875rem;
    font-weight: 500;
    color: var(--text-secondary);
  }
  
  .category-progress {
    width: 100%;
    height: 4px;
    background: var(--gray-800);
    border-radius: 2px;
    margin-bottom: 1.5rem;
    overflow: hidden;
  }
  
  .category-progress-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--primary), var(--success));
    border-radius: 2px;
    transition: width 0.3s ease;
    width: 0%;
  }

  /* Questions */
  .question {
    margin-bottom: 1.5rem;
    padding: 1rem;
    border: 1px solid transparent;
    border-radius: 8px;
    transition: all 0.2s ease;
  }
  
  .question:hover {
    background: rgba(255, 255, 255, 0.02);
  }
  
  .question.answered {
    border-color: var(--success);
    background: rgba(16, 185, 129, 0.05);
  }
  
  .question-label {
    display: block;
    margin-bottom: 1rem;
    font-weight: 500;
    font-size: 1rem;
  }
  
  .question-number {
    color: var(--text-secondary);
    font-weight: 400;
    margin-right: 0.5rem;
  }

  /* Radio Groups */
  .radio-group {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 0.75rem;
  }
  
  .radio-option {
    position: relative;
  }
  
  .radio-option input {
    position: absolute;
    opacity: 0;
    pointer-events: none;
  }
  
  .radio-option label {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0.75rem 1rem;
    background: var(--gray-800);
    border: 2px solid var(--gray-700);
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.15s ease;
    font-size: 0.875rem;
    font-weight: 500;
    text-align: center;
    min-height: 48px;
  }
  
  .radio-option label:hover {
    border-color: var(--gray-600);
    background: var(--gray-700);
  }
  
  .radio-option input:checked + label {
    border-color: var(--primary);
    background: rgba(99, 102, 241, 0.1);
    color: var(--primary);
  }
  
  .radio-option:nth-child(1) input:checked + label {
    border-color: var(--error);
    background: rgba(239, 68, 68, 0.1);
    color: var(--error);
  }
  
  .radio-option:nth-child(2) input:checked + label {
    border-color: var(--warning);
    background: rgba(245, 158, 11, 0.1);
    color: var(--warning);
  }
  
  .radio-option:nth-child(3) input:checked + label {
    border-color: var(--success);
    background: rgba(16, 185, 129, 0.1);
    color: var(--success);
  }

  /* Keyboard Navigation */
  .radio-option input:focus + label {
    outline: 2px solid var(--primary);
    outline-offset: 2px;
  }

  /* Notifications */
  .notification {
    position: fixed;
    top: 1rem;
    right: 1rem;
    padding: 1rem 1.5rem;
    background: var(--success);
    color: white;
    border-radius: 8px;
    font-weight: 500;
    z-index: 1000;
    transform: translateX(100%);
    transition: transform 0.3s ease;
  }
  
  .notification.show {
    transform: translateX(0);
  }
  
  .notification.error {
    background: var(--error);
  }

  /* Auto-save indicator */
  .autosave-indicator {
    font-size: 0.75rem;
    color: var(--text-secondary);
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }
  
  .autosave-indicator.saving {
    color: var(--warning);
  }
  
  .autosave-indicator.saved {
    color: var(--success);
  }

  /* Responsive Design */
  @media (max-width: 1024px) {
    .container {
      grid-template-columns: 1fr;
      gap: 1rem;
    }
    
    .score-panel {
      position: static;
      order: -1;
    }
  }
  
  @media (max-width: 768px) {
    .progress-content {
      flex-direction: column;
      gap: 0.5rem;
    }
    
    .progress-info {
      order: 1;
    }
    
    .action-buttons {
      flex-wrap: wrap;
    }
    
    .radio-group {
      grid-template-columns: 1fr;
      gap: 0.5rem;
    }
    
    .category {
      padding: 1.5rem;
    }
    
    .container {
      padding: 1rem;
    }
  }

  /* Loading states */
  .loading {
    opacity: 0.6;
    pointer-events: none;
  }

  /* Accessibility improvements */
  @media (prefers-reduced-motion: reduce) {
    * {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
    }
  }
</style>
</head>
<body>
  <div class="progress-header">
    <div class="progress-content">
      <div class="progress-info">
        <span id="progressText">Frage 0 von 50</span>
        <div class="autosave-indicator" id="autosaveIndicator">
          <span>●</span>
          <span>Automatisch gespeichert</span>
        </div>
      </div>
      
      <div class="progress-bar-container">
        <div class="progress-bar" id="progressBar"></div>
      </div>
      
      <div class="category-nav" id="categoryNav"></div>
      
      <div class="action-buttons">
        <button class="btn" onclick="exportData()" title="Daten exportieren">
          <span>↓</span> Export
        </button>
        <button class="btn" onclick="importData()" title="Daten importieren">
          <span>↑</span> Import
        </button>
        <button class="btn primary" onclick="resetData()" title="Zurücksetzen">
          Reset
        </button>
      </div>
    </div>
  </div>

  <div class="container">
    <main class="categories" id="categories"></main>
    
    <aside class="score-panel">
      <div class="score-header">
        <h3>Gesundheitsscore</h3>
        <div class="score-date" id="scoreDate"></div>
      </div>
      
      <div class="score-ring">
        <div class="score-circle" id="scoreCircle">
          <div class="score-value">
            <div id="totalScore">0</div>
            <div class="score-percentage" id="scorePercentage">0%</div>
          </div>
        </div>
      </div>
      
      <div class="score-stats">
        <div class="stat-item">
          <div class="stat-value" id="answeredCount">0</div>
          <div class="stat-label">Beantwortet</div>
        </div>
        <div class="stat-item">
          <div class="stat-value" id="completedCategories">0</div>
          <div class="stat-label">Kategorien</div>
        </div>
        <div class="stat-item">
          <div class="stat-value" id="averageScore">0%</div>
          <div class="stat-label">Durchschnitt</div>
        </div>
        <div class="stat-item">
          <div class="stat-value" id="timeSpent">0m</div>
          <div class="stat-label">Zeit</div>
        </div>
      </div>
    </aside>
  </div>

  <div class="notification" id="notification"></div>
  <input type="file" id="fileInput" accept=".json" style="display: none;">

  <script>
    // Modern ES6+ Implementation with enterprise patterns
    class HealthAssessment {
      constructor() {
        this.categories = [
          {
            title: 'Schlaf & Erholung',
            questions: [
              'Schläfst du mindestens 7–8 Stunden pro Nacht?',
              'Hast du einen regelmäßigen Schlaf-Wach-Rhythmus?',
              'Wachst du ohne Wecker erholt auf?',
              'Schläfst du ohne Unterbrechungen durch?',
              'Vermeidest du Blaulicht 2h vor dem Schlafengehen?',
              'Schläfst du in einem völlig dunklen Raum?',
              'Wachst du erfrischt und energiegeladen auf?',
              'Vermeidest du späte und schwere Mahlzeiten?',
              'Kommst du ohne Schlafmittel oder Alkohol aus?',
              'Fühlst du dich tagsüber wach und konzentriert?'
            ]
          },
          {
            title: 'Ernährung & Supplements',
            questions: [
              'Verzichtest du weitgehend auf raffinierten Zucker?',
              'Isst du täglich mindestens 5 Portionen Gemüse/Obst?',
              'Trinkst du täglich 2-3 Liter reines Wasser?',
              'Verwendest du Supplements gezielt nach Bedarf?',
              'Hast du regelmäßige und bewusste Essenszeiten?',
              'Isst du ballaststoffreich und nährstoffdicht?',
              'Vermeidest du hochverarbeitete Fertigprodukte?',
              'Meidest du künstliche Zusätze und Konservierungsstoffe?',
              'Hast du eine gesunde Verdauung ohne Probleme?',
              'Verzichtest du auf künstliche Süßstoffe?'
            ]
          },
          {
            title: 'Training & Bewegung',
            questions: [
              'Bewegst du dich täglich mindestens 30 Minuten?',
              'Trainierst du 3-4x pro Woche strukturiert?',
              'Schaffst du problemlos 10.000 Schritte täglich?',
              'Bist du schmerzfrei und beweglich?',
              'Hast du klare sportliche Ziele und Motivation?',
              'Folgst du einem durchdachten Trainingsplan?',
              'Trainierst du regelmäßig deine Ausdauer?',
              'Trainierst du systematisch deine Kraft?',
              'Bist du flexibel und hast gute Mobilität?',
              'Kannst du problemlos länger laufen/gehen?'
            ]
          },
          {
            title: 'Mindset & Stressmanagement',
            questions: [
              'Fühlst du dich selten überwältigt oder gestresst?',
              'Praktizierst du regelmäßig Meditation oder Achtsamkeit?',
              'Umgibst du dich mit positiven Einflüssen?',
              'Hast du klare Lebensziele und Prioritäten?',
              'Lebst du nach deinen persönlichen Werten?',
              'Hast du eine grundsätzlich optimistische Einstellung?',
              'Vermeidest du Multitasking und Ablenkungen?',
              'Hast du starke soziale Verbindungen und Unterstützung?',
              'Kannst du nach der Arbeit wirklich abschalten?',
              'Fühlst du dich meistens glücklich und erfüllt?'
            ]
          },
          {
            title: 'Lifestyle & Umwelt',
            questions: [
              'Rauchst du nicht und meidest Passivrauchen?',
              'Trinkst du maximal 1-2 Gläser Alkohol pro Woche?',
              'Vermeidest du Plastik bei Lebensmitteln und Getränken?',
              'Hast du Zugang zu sauberem, gefiltertem Wasser?',
              'Meidest du schädliche Chemikalien im Alltag?',
              'Verwendest du natürliche Körperpflege ohne Toxine?',
              'Schläfst du in einem schadstofffreien Umfeld?',
              'Bekommst du täglich natürliches Tageslicht?',
              'Verbringst du regelmäßig Zeit in der Natur?',
              'Führst du einen bewusst nachhaltigen Lebensstil?'
            ]
          }
        ];
        
        this.answers = this.loadData() || this.initializeAnswers();
        this.startTime = Date.now();
        this.autosaveInterval = null;
        
        this.init();
      }
      
      initializeAnswers() {
        return this.categories.map(cat => new Array(cat.questions.length).fill(null));
      }
      
      init() {
        this.renderCategories();
        this.renderCategoryNav();
        this.updateUI();
        this.setupKeyboardNavigation();
        this.startAutosave();
        this.updateTimeSpent();
      }
      
      renderCategories() {
        const container = document.getElementById('categories');
        container.innerHTML = '';
        
        this.categories.forEach((category, catIdx) => {
          const categoryEl = this.createCategoryElement(category, catIdx);
          container.appendChild(categoryEl);
        });
      }
      
      createCategoryElement(category, catIdx) {
        const categoryEl = document.createElement('section');
        categoryEl.className = 'category';
        categoryEl.id = `category-${catIdx}`;
        
        categoryEl.innerHTML = `
          <div class="category-header">
            <h2 class="category-title">${category.title}</h2>
            <div class="category-score" id="score-${catIdx}">0 / 20</div>
          </div>
          <div class="category-progress">
            <div class="category-progress-fill" id="progress-${catIdx}"></div>
          </div>
          <div class="questions">
            ${category.questions.map((question, qIdx) => 
              this.createQuestionHTML(question, catIdx, qIdx)
            ).join('')}
          </div>
        `;
        
        return categoryEl;
      }
      
      createQuestionHTML(question, catIdx, qIdx) {
        const isAnswered = this.answers[catIdx][qIdx] !== null;
        return `
          <div class="question ${isAnswered ? 'answered' : ''}" id="question-${catIdx}-${qIdx}">
            <label class="question-label">
              <span class="question-number">${qIdx + 1}.</span>
              ${question}
            </label>
            <div class="radio-group">
              ${['Nein', 'Teilweise', 'Ja'].map((text, val) => `
                <div class="radio-option">
                  <input type="radio" 
                         name="cat${catIdx}_q${qIdx}" 
                         value="${val}" 
                         id="cat${catIdx}_q${qIdx}_v${val}"
                         ${this.answers[catIdx][qIdx] === val ? 'checked' : ''}
                         onchange="app.handleAnswer(${catIdx}, ${qIdx}, ${val})">
                  <label for="cat${catIdx}_q${qIdx}_v${val}">${text}</label>
                </div>
              `).join('')}
            </div>
          </div>
        `;
      }
      
      renderCategoryNav() {
        const nav = document.getElementById('categoryNav');
        nav.innerHTML = '';
        
        this.categories.forEach((cat, idx) => {
          const dot = document.createElement('div');
          dot.className = 'category-dot';
          dot.title = cat.title;
          dot.onclick = () => this.scrollToCategory(idx);
          nav.appendChild(dot);
        });
      }
      
      handleAnswer(catIdx, qIdx, value) {
        this.answers[catIdx][qIdx] = parseInt(value);
        
        // Update question state
        const questionEl = document.getElementById(`question-${catIdx}-${qIdx}`);
        questionEl.classList.add('answered');
        
        this.updateUI();
        this.saveData();
        this.showAutosaveIndicator('saving');
        
        // Auto-advance to next question
        setTimeout(() => this.focusNextQuestion(catIdx, qIdx), 100);
      }
      
      focusNextQuestion(catIdx, qIdx) {
        // Find next unanswered question
        for (let c = catIdx; c < this.categories.length; c++) {
          const startQ = (c === catIdx) ? qIdx + 1 : 0;
          for (let q = startQ; q < this.categories[c].questions.length; q++) {
            if (this.answers[c][q] === null) {
              const nextQuestion = document.getElementById(`question-${c}-${q}`);
              if (nextQuestion) {
                nextQuestion.scrollIntoView({ behavior: 'smooth', block: 'center' });
                // Focus first radio button
                const firstRadio = nextQuestion.querySelector('input[type="radio"]');
                if (firstRadio) firstRadio.focus();
              }
              return;
            }
          }
        }
      }
      
      updateUI() {
        this.updateProgress();
        this.updateScorePanel();
        this.updateCategoryNav();
        this.updateCategoryStates();
      }
      
      updateProgress() {
        const totalQuestions = this.categories.reduce((sum, cat) => sum + cat.questions.length, 0);
        const answeredQuestions = this.answers.flat().filter(answer => answer !== null).length;
        const progress = (answeredQuestions / totalQuestions) * 100;
        
        document.getElementById('progressBar').style.width = `${progress}%`;
        document.getElementById('progressText').textContent = `Frage ${answeredQuestions} von ${totalQuestions}`;
      }
      
      updateScorePanel() {
        const totalScore = this.calculateTotalScore();
        const maxScore = this.categories.reduce((sum, cat) => sum + cat.questions.length * 2, 0);
        const percentage = maxScore > 0 ? Math.round((totalScore / maxScore) * 100) : 0;
        const answeredCount = this.answers.flat().filter(answer => answer !== null).length;
        const totalQuestions = this.categories.reduce((sum, cat) => sum + cat.questions.length, 0);
        const completedCategories = this.answers.filter(catAnswers => 
          catAnswers.every(answer => answer !== null)
        ).length;
        
        // Update score circle
        const scoreCircle = document.getElementById('scoreCircle');
        const degrees = (percentage / 100) * 360;
        scoreCircle.style.background = `conic-gradient(var(--primary) ${degrees}deg, var(--gray-700) ${degrees}deg)`;
        
        // Update values
        document.getElementById('totalScore').textContent = totalScore;
        document.getElementById('scorePercentage').textContent = `${percentage}%`;
        document.getElementById('answeredCount').textContent = `${answeredCount}/${totalQuestions}`;
        document.getElementById('completedCategories').textContent = `${completedCategories}/5`;
        document.getElementById('averageScore').textContent = `${percentage}%`;
        document.getElementById('scoreDate').textContent = `Stand: ${new Date().toLocaleDateString('de-DE')}`;
      }
      
      updateCategoryNav() {
        const dots = document.querySelectorAll('.category-dot');
        this.answers.forEach((categoryAnswers, idx) => {
          const isCompleted = categoryAnswers.every(answer => answer !== null);
          const hasAnswers = categoryAnswers.some(answer => answer !== null);
          
          dots[idx].classList.toggle('completed', isCompleted);
          dots[idx].classList.toggle('active', hasAnswers && !isCompleted);
        });
      }
      
      updateCategoryStates() {
        this.categories.forEach((category, catIdx) => {
          const categoryEl = document.getElementById(`category-${catIdx}`);
          const categoryAnswers = this.answers[catIdx];
          const answered = categoryAnswers.filter(answer => answer !== null).length;
          const score = categoryAnswers.reduce((sum, answer) => sum + (answer || 0), 0);
          const progress = (answered / category.questions.length) * 100;
          
          // Update category visual state
          const isCompleted = answered === category.questions.length;
          categoryEl.classList.toggle('active', answered > 0 && !isCompleted);
        });
      }
      
      calculateTotalScore() {
        return this.answers.flat().reduce((sum, answer) => sum + (answer || 0), 0);
      }
      
      scrollToCategory(index) {
        const categoryEl = document.getElementById(`category-${index}`);
        if (categoryEl) {
          categoryEl.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
      }
      
      setupKeyboardNavigation() {
        document.addEventListener('keydown', (e) => {
          if (e.target.type === 'radio') {
            const name = e.target.name;
            const radios = document.querySelectorAll(`input[name="${name}"]`);
            const currentIndex = Array.from(radios).indexOf(e.target);
            
            switch(e.key) {
              case 'ArrowLeft':
              case 'ArrowUp':
                e.preventDefault();
                if (currentIndex > 0) radios[currentIndex - 1].focus();
                break;
              case 'ArrowRight':
              case 'ArrowDown':
                e.preventDefault();
                if (currentIndex < radios.length - 1) radios[currentIndex + 1].focus();
                break;
              case 'Enter':
              case ' ':
                e.preventDefault();
                e.target.checked = true;
                e.target.onchange();
                break;
            }
          }
          
          // Global shortcuts
          if (e.ctrlKey || e.metaKey) {
            switch(e.key) {
              case 's':
                e.preventDefault();
                this.exportData();
                break;
              case 'r':
                e.preventDefault();
                this.resetData();
                break;
            }
          }
        });
      }
      
      startAutosave() {
        this.autosaveInterval = setInterval(() => {
          this.saveData();
          this.showAutosaveIndicator('saved');
        }, 30000); // Save every 30 seconds
      }
      
      updateTimeSpent() {
        setInterval(() => {
          const elapsed = Math.floor((Date.now() - this.startTime) / 60000);
          document.getElementById('timeSpent').textContent = `${elapsed}m`;
        }, 60000); // Update every minute
      }
      
      showAutosaveIndicator(state) {
        const indicator = document.getElementById('autosaveIndicator');
        indicator.className = `autosave-indicator ${state}`;
        
        if (state === 'saving') {
          indicator.innerHTML = '<span>●</span><span>Speichere...</span>';
          setTimeout(() => this.showAutosaveIndicator('saved'), 1000);
        } else if (state === 'saved') {
          indicator.innerHTML = '<span>●</span><span>Automatisch gespeichert</span>';
        }
      }
      
      saveData() {
        const data = {
          answers: this.answers,
          timestamp: Date.now(),
          version: '3.0',
          startTime: this.startTime
        };
        localStorage.setItem('nh-score-data', JSON.stringify(data));
      }
      
      loadData() {
        try {
          const saved = localStorage.getItem('nh-score-data');
          if (saved) {
            const data = JSON.parse(saved);
            if (data.version === '3.0' && data.answers) {
              this.startTime = data.startTime || Date.now();
              return data.answers;
            }
          }
        } catch (e) {
          console.warn('Failed to load saved data:', e);
        }
        return null;
      }
      
      exportData() {
        const data = {
          answers: this.answers,
          timestamp: Date.now(),
          version: '3.0',
          score: this.calculateTotalScore(),
          categories: this.categories.map((cat, idx) => ({
            title: cat.title,
            score: this.answers[idx].reduce((sum, answer) => sum + (answer || 0), 0),
            answered: this.answers[idx].filter(answer => answer !== null).length,
            total: cat.questions.length
          }))
        };
        
        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `nh-score-${new Date().toISOString().split('T')[0]}.json`;
        a.click();
        URL.revokeObjectURL(url);
        
        this.showNotification('Daten erfolgreich exportiert', 'success');
      }
      
      importData() {
        const fileInput = document.getElementById('fileInput');
        fileInput.onchange = (e) => {
          const file = e.target.files[0];
          if (file) {
            const reader = new FileReader();
            reader.onload = (e) => {
              try {
                const data = JSON.parse(e.target.result);
                if (data.answers && Array.isArray(data.answers)) {
                  this.answers = data.answers;
                  this.startTime = data.startTime || Date.now();
                  this.renderCategories();
                  this.updateUI();
                  this.saveData();
                  this.showNotification('Daten erfolgreich importiert', 'success');
                } else {
                  throw new Error('Invalid data format');
                }
              } catch (error) {
                this.showNotification('Fehler beim Importieren der Daten', 'error');
              }
            };
            reader.readAsText(file);
          }
        };
        fileInput.click();
      }
      
      resetData() {
        if (confirm('Möchten Sie wirklich alle Antworten zurücksetzen? Diese Aktion kann nicht rückgängig gemacht werden.')) {
          this.answers = this.initializeAnswers();
          this.startTime = Date.now();
          localStorage.removeItem('nh-score-data');
          this.renderCategories();
          this.updateUI();
          this.showNotification('Alle Daten wurden zurückgesetzt', 'success');
        }
      }
      
      showNotification(message, type = 'success') {
        const notification = document.getElementById('notification');
        notification.textContent = message;
        notification.className = `notification ${type}`;
        notification.classList.add('show');
        
        setTimeout(() => {
          notification.classList.remove('show');
        }, 3000);
      }
    }
    
    // Global functions for onclick handlers
    window.exportData = () => app.exportData();
    window.importData = () => app.importData();
    window.resetData = () => app.resetData();
    
    // Initialize app when DOM is ready
    let app;
    document.addEventListener('DOMContentLoaded', () => {
      app = new HealthAssessment();
    });
  </script>
</body>
</html> category score and progress
          document.getElementById(`score-${catIdx}`).textContent = `${score} / 20`;
          document.getElementById(`progress-${catIdx}`).style.width = `${progress}%`;
          
          // Update
